<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.6 -->
    <script>
        window.materialVersion = "1.5.6"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0',
            '1.5.2',
            '1.5.5'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">





    <link rel="dns-prefetch" href="https://imsun.github.io">





    <link rel="dns-prefetch" href="https://fonts.googleapis.com">





    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Title -->
    
    <title>
        
            一块小饼干-Cookie-的故事-上篇 | 
        
        WuShaoLin&#39;s Blog
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/tiger.png">
    <link rel="icon" href="/img/tiger.png">

    <meta name="format-detection" content="telephone=no">
    <meta name="description" itemprop="description" content="
cookie 如果非要用汉语理解的话应该是 一段小型文本文件，由网景的创始人之一的卢 蒙特利在93年发明。
上篇是熟悉一下注册的大致流程，下篇熟悉登录流程以及真正的Cookie

实现基本的注册功能我们打开网站，浏览网站，最常见的两个操作就是注册以及登录，所以有必要探索一下这两个功能如何实现的。
本地模拟，当输入localhost:8080/sign_up的时候，浏览器发起get请求，服务器给你响应sign_up.html
12345678//服务器端代码if (path === &#39;/sign_up&#39; &amp;amp;&amp;amp; method === &#39;GET&#39;) &amp;#123;    let string = fs.readFileSync(&#39;./sign_up.html&#39;, &#39;utf8&#39;)    response.statusCode = 200    response.setHeader(&#39;Content-Type&#39;, &#39;text/html;charset=utf-8&#39;)    response.write(string)    response.end() &amp;#125;">
    <meta name="keywords" content=",HTTP">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?NKhlKQkXw/c66TR5p4wO+w==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-image: url(/img/bg.png);
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","/css/material-icons.css?pqhB/Rd/ab0H2+kZp0RDmw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==", true)</script>
    

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="WuShaoLin&#39;s Blog">
    <meta name="msapplication-starturl" content="https://codevvvv9.github.io/2018/02/09/一块小饼干-Cookie-的故事-上篇/">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="WuShaoLin&#39;s Blog">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/img/tiger.png">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="https://codevvvv9.github.io/2018/02/09/一块小饼干-Cookie-的故事-上篇/">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="一块小饼干-Cookie-的故事-上篇 | WuShaoLin&#39;s Blog">
    <meta property="og:image" content="/img/tiger.png">
    <meta property="og:description" content="
cookie 如果非要用汉语理解的话应该是 一段小型文本文件，由网景的创始人之一的卢 蒙特利在93年发明。
上篇是熟悉一下注册的大致流程，下篇熟悉登录流程以及真正的Cookie

实现基本的注册功能我们打开网站，浏览网站，最常见的两个操作就是注册以及登录，所以有必要探索一下这两个功能如何实现的。
本地模拟，当输入localhost:8080/sign_up的时候，浏览器发起get请求，服务器给你响应sign_up.html
12345678//服务器端代码if (path === &#39;/sign_up&#39; &amp;amp;&amp;amp; method === &#39;GET&#39;) &amp;#123;    let string = fs.readFileSync(&#39;./sign_up.html&#39;, &#39;utf8&#39;)    response.statusCode = 200    response.setHeader(&#39;Content-Type&#39;, &#39;text/html;charset=utf-8&#39;)    response.write(string)    response.end() &amp;#125;">
    <meta property="og:article:tag" content="HTTP"> 

    
        <meta property="article:published_time" content="Fri Feb 09 2018 23:28:24 GMT+0800">
        <meta property="article:modified_time" content="Sun Nov 18 2018 17:46:05 GMT+0800">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="https://codevvvv9.github.io/2018/02/09/一块小饼干-Cookie-的故事-上篇/index.html">
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "https://codevvvv9.github.io/2018/02/09/一块小饼干-Cookie-的故事-上篇/index.html",
    "headline": "一块小饼干-Cookie-的故事-上篇",
    "datePublished": "Fri Feb 09 2018 23:28:24 GMT+0800",
    "dateModified": "Sun Nov 18 2018 17:46:05 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "shaolin-wu",
        "image": {
            "@type": "ImageObject",
            "url": "/img/avatar.jpeg"
        },
        "description": "悟已往之不谏，知来者之可追"
    },
    "publisher": {
        "@type": "Organization",
        "name": "WuShaoLin&#39;s Blog",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/tiger.png"
        }
    },
    "keywords": ",HTTP",
    "description": "
cookie 如果非要用汉语理解的话应该是 一段小型文本文件，由网景的创始人之一的卢 蒙特利在93年发明。
上篇是熟悉一下注册的大致流程，下篇熟悉登录流程以及真正的Cookie

实现基本的注册功能我们打开网站，浏览网站，最常见的两个操作就是注册以及登录，所以有必要探索一下这两个功能如何实现的。
本地模拟，当输入localhost:8080/sign_up的时候，浏览器发起get请求，服务器给你响应sign_up.html
12345678//服务器端代码if (path === &#39;/sign_up&#39; &amp;amp;&amp;amp; method === &#39;GET&#39;) &amp;#123;    let string = fs.readFileSync(&#39;./sign_up.html&#39;, &#39;utf8&#39;)    response.statusCode = 200    response.setHeader(&#39;Content-Type&#39;, &#39;text/html;charset=utf-8&#39;)    response.write(string)    response.end() &amp;#125;",
}
</script>


    

    <!-- Analytics -->
    
    
    

    <!-- Custom Head -->
    

</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span id="MD-burger-id" class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn" class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#实现基本的注册功能"><span class="post-toc-number">1.</span> <span class="post-toc-text">实现基本的注册功能</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#CSS布局的几个小坑"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">CSS布局的几个小坑</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#获得用户的数据"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">获得用户的数据</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#非空验证"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">非空验证</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#使用ajax提交数据"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">使用ajax提交数据</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#服务器端解析formData"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">服务器端解析formData</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#服务器端简单的校验"><span class="post-toc-number">2.</span> <span class="post-toc-text">服务器端简单的校验</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#校验前的准备工作"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">校验前的准备工作</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#由-编码引发的bug"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">由@编码引发的bug</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#错误信息的提示方法"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">错误信息的提示方法</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#校验邮箱是否已经存在了"><span class="post-toc-number">2.4.</span> <span class="post-toc-text">校验邮箱是否已经存在了</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#把信息写入数据库"><span class="post-toc-number">2.5.</span> <span class="post-toc-text">把信息写入数据库</span></a></li></ol></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 15 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                一块小饼干-Cookie-的故事-上篇
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.jpeg" width="44px" height="44px" alt="Author Avatar">
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>shaolin-wu</strong>
        <span>2月 09, 2018</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/HTTP/">HTTP</a>
    </li></ul>
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=一块小饼干-Cookie-的故事-上篇&url=https://codevvvv9.github.io/2018/02/09/一块小饼干-Cookie-的故事-上篇/index.html&pic=https://codevvvv9.github.io/img/tiger.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=一块小饼干-Cookie-的故事-上篇&url=https://codevvvv9.github.io/2018/02/09/一块小饼干-Cookie-的故事-上篇/index.html&via=shaolin-wu" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=https://codevvvv9.github.io/2018/02/09/一块小饼干-Cookie-的故事-上篇/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=https://codevvvv9.github.io/2018/02/09/一块小饼干-Cookie-的故事-上篇/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    
        <a class="post_share-link" href="https://www.linkedin.com/shareArticle?mini=true&url=https://codevvvv9.github.io/2018/02/09/一块小饼干-Cookie-的故事-上篇/index.html&title=一块小饼干-Cookie-的故事-上篇" target="_blank">
            <li class="mdl-menu__item">
                分享到 LinkedIn
            </li>
        </a>
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <blockquote>
<p>cookie 如果非要用汉语理解的话应该是 一段小型文本文件，由网景的创始人之一的<a href="https://zh.wikipedia.org/wiki/%E7%9B%A7%C2%B7%E8%92%99%E7%89%B9%E5%88%A9" target="_blank" rel="noopener">卢 蒙特利</a>在93年发明。</p>
<p>上篇是熟悉一下注册的大致流程，下篇熟悉登录流程以及真正的Cookie</p>
</blockquote>
<h2 id="实现基本的注册功能"><a href="#实现基本的注册功能" class="headerlink" title="实现基本的注册功能"></a>实现基本的注册功能</h2><p>我们打开网站，浏览网站，最常见的两个操作就是注册以及登录，所以有必要探索一下这两个功能如何实现的。</p>
<p>本地模拟，当输入<code>localhost:8080/sign_up</code>的时候，浏览器发起<code>get</code>请求，服务器给你响应<code>sign_up.html</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//服务器端代码</span></span><br><span class="line"><span class="keyword">if</span> (path === <span class="string">'/sign_up'</span> &amp;&amp; method === <span class="string">'GET'</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> string = fs.readFileSync(<span class="string">'./sign_up.html'</span>, <span class="string">'utf8'</span>)</span><br><span class="line">    response.statusCode = <span class="number">200</span></span><br><span class="line">    response.setHeader(<span class="string">'Content-Type'</span>, <span class="string">'text/html;charset=utf-8'</span>)</span><br><span class="line">    response.write(string)</span><br><span class="line">    response.end()</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h3 id="CSS布局的几个小坑"><a href="#CSS布局的几个小坑" class="headerlink" title="CSS布局的几个小坑"></a>CSS布局的几个小坑</h3><p>在写<code>sign_up.html</code>的时候，注意几点css知识：</p>
<ol>
<li>如果想让你的登录页面的body占满整个屏幕，随着窗口的大小变化而变化的话，可以写</li>
</ol>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span>, <span class="selector-tag">html</span>&#123;<span class="attribute">height</span>: <span class="number">100%</span>&#125;</span><br><span class="line">//或者</span><br><span class="line"><span class="selector-tag">body</span>&#123;<span class="attribute">min-height</span>: <span class="number">100%</span>&#125;</span><br><span class="line"><span class="selector-tag">html</span>&#123;<span class="attribute">height</span>: <span class="number">100%</span>&#125;</span><br><span class="line">//不能这么写</span><br><span class="line"><span class="selector-tag">body</span>, <span class="selector-tag">html</span>&#123;<span class="attribute">min-height</span>: <span class="number">100%</span>&#125;</span><br></pre></td></tr></table></figure>
<p>当然了，实际上这么写就可以了</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span>&#123;<span class="attribute">min-height</span>: <span class="number">100vh</span>&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li><code>label</code>标签是<code>display: inline</code>，不能设置宽度，<strong>行内元素则会根据行内内容自适应宽度</strong>，所以行内元素设置width是没有效果的。改成<code>inline-block就可以了</code></li>
</ol>
<p><img src="http://p3tha6q4v.bkt.clouddn.com/18-2-8/78722664.jpg" alt="很丑的界面的"></p>
<h3 id="获得用户的数据"><a href="#获得用户的数据" class="headerlink" title="获得用户的数据"></a>获得用户的数据</h3><p>既然是注册的需求，那么我们首要关注的点就是–用户的注册信息我们如何获得呢</p>
<p>选择合理的数据结构存储数据是很重要的。</p>
<ol>
<li>每个<code>input</code>的<code>name</code>可以使用数组存储</li>
<li><code>input</code>的<code>value</code>应该使用<code>hash</code>,也就是对象来存储。</li>
<li>上述的套路会一直用下去，<strong><code>hash+[]</code></strong>的组合。</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用jq来写</span></span><br><span class="line"><span class="keyword">let</span> hash = &#123;&#125;</span><br><span class="line"><span class="keyword">let</span> $form = $(<span class="string">'#signUpForm'</span>)</span><br><span class="line">$form.on(<span class="string">'submit'</span>, (e) =&gt; &#123;</span><br><span class="line">  e.preventDefault() <span class="comment">//不用form表单的默认提交，而是使用我们的的ajax提交</span></span><br><span class="line">  <span class="keyword">let</span> need = [<span class="string">'email'</span>, <span class="string">'password'</span>, <span class="string">'password_confirmation'</span>]</span><br><span class="line">  need.forEach(<span class="function">(<span class="params">name</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> value = $form.find(<span class="string">`[name=<span class="subst">$&#123;name&#125;</span>]`</span>).val()</span><br><span class="line">  hash[name] = value</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>最终<code>hash</code>里面存储的就是</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">'email'</span>: <span class="string">'...'</span>,</span><br><span class="line">  <span class="string">'password'</span>: <span class="string">'...'</span>,</span><br><span class="line">  <span class="string">'password_confirmation'</span>: <span class="string">'...'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>到目前为止我们把用户的数据封装到了一个对象里面了。</p>
<p>不过在把hash用ajax发出去之前要先进行一些必要的非空验证</p>
<h3 id="非空验证"><a href="#非空验证" class="headerlink" title="非空验证"></a>非空验证</h3><p>主要是检测邮箱是否为空、密码是否为空、两次输入的密码是否一致。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//发起请求之前验证是否为空</span></span><br><span class="line"><span class="keyword">if</span> (hash[<span class="string">'email'</span>] === <span class="string">''</span>) &#123;</span><br><span class="line">  $form.find(<span class="string">'[name="email"]'</span>).siblings(<span class="string">'.errors'</span>).text(<span class="string">'请您输入邮箱'</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span> <span class="comment">//精髓啊，不然没用了</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (hash[<span class="string">'password'</span>] === <span class="string">''</span>) &#123;</span><br><span class="line">  $form.find(<span class="string">'[name="password"]'</span>).siblings(<span class="string">'.errors'</span>).text(<span class="string">'请您输入密码'</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span> <span class="comment">//精髓啊，不然没用了</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (hash[<span class="string">'password_confirmation'</span>] === <span class="string">''</span>) &#123;</span><br><span class="line">    $form.find(<span class="string">'[name="password_confirmation"]'</span>).siblings(<span class="string">'.errors'</span>).text(<span class="string">'请您再次输入确认密码'</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span> <span class="comment">//精髓啊，不然没用了</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (hash[<span class="string">'password'</span>] !== hash[<span class="string">'password_confirmation'</span>]) &#123;</span><br><span class="line">  $form.find(<span class="string">'[name="password_confirmation"]'</span>).siblings(<span class="string">'.errors'</span>).text(<span class="string">'两次输入密码不匹配'</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span> <span class="comment">//精髓啊，不然没用了</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>如果忘记写return的话，即使你为空了还是会直接越过这一步检测，去发起ajax请求的，所以一定不要忘了写上return false.</li>
<li>如果仅仅这么写的话会有一个bug。当出现错误提示后，你把信息填对了，错误信息依然显示，这显然是不合理的。应该填入信息后，错误信息就消失的。</li>
</ul>
<p><img src="http://p3tha6q4v.bkt.clouddn.com/18-2-8/78635036.jpg" alt="bug"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$form.find(<span class="string">'.errors'</span>).each(<span class="function">(<span class="params">index, span</span>) =&gt;</span> &#123;</span><br><span class="line">	$(span).text(<span class="string">''</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>使用上述的jq代码来解决这个bug即可。</p>
<p>非空验证完了之后，意味着浏览器收集用户数据的工作完成了，可以把hash发到服务器端了，接下来就是ajax请求了。</p>
<h3 id="使用ajax提交数据"><a href="#使用ajax提交数据" class="headerlink" title="使用ajax提交数据"></a>使用ajax提交数据</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$.post(<span class="string">'/sign_up'</span>, hash)</span><br><span class="line">.then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//成功了就打印这个  </span></span><br><span class="line">  <span class="built_in">console</span>.log(response)</span><br><span class="line">&#125;,</span><br><span class="line">() =&gt; &#123;</span><br><span class="line">  <span class="comment">//错误了打印这个</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="服务器端解析formData"><a href="#服务器端解析formData" class="headerlink" title="服务器端解析formData"></a>服务器端解析formData</h3><p>因为formData是一段一段上传的(具体原因略复杂，可以取极限法，如果formdata很多，不可能一下子上传过来)，自己不会写，就去搜索代码片段解析formdata</p>
<p><code>google: node get post data</code></p>
<p>把获得的代码封装成了一个函数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readBody</span>(<span class="params">request</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> body = []</span><br><span class="line">      request.on(<span class="string">'data'</span>, (chunk) =&gt; &#123;</span><br><span class="line">        body.push(chunk)</span><br><span class="line">      &#125;).on(<span class="string">'end'</span>, () =&gt; &#123;</span><br><span class="line">        body = Buffer.concat(body).toString();</span><br><span class="line">          resolve(body)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如何使用上述代码片段呢</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="keyword">if</span> (path === <span class="string">'/sign_up'</span> &amp;&amp; method === <span class="string">'POST'</span>) &#123;</span><br><span class="line">    readBody(request).then(<span class="function">(<span class="params">body</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> strings = body.split(<span class="string">'&amp;'</span>) <span class="comment">//['email=1', 'password=2', 'password_confirmmation=3']</span></span><br><span class="line">      <span class="keyword">let</span> hash = &#123;&#125;</span><br><span class="line">      strings.forEach(<span class="function"><span class="params">string</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">//想得到类似这种的 string == 'email=1'</span></span><br><span class="line">        <span class="keyword">let</span> parts = string.split(<span class="string">'='</span>) <span class="comment">//再用=分割,得到['email', '1']</span></span><br><span class="line">        <span class="keyword">let</span> key = parts[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">let</span> value = parts[<span class="number">1</span>]</span><br><span class="line">        hash[key] = <span class="built_in">decodeURIComponent</span>(value)<span class="comment">//hash['email'] = '1'</span></span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="keyword">let</span> &#123;email, password, password_confirmation&#125; = hash <span class="comment">//ES6的解构赋值</span></span><br><span class="line">  &#125;</span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<p>当服务器端接收到了所有的formdata数据后，其实是一串形如<code>email=1&amp;password=2&amp;password_confirmation=3</code></p>
<p>的字符串，所以我们考虑使用<code>&amp;</code>字符分割成数组。</p>
<ul>
<li>得到一个形如<code>[&#39;email=1&#39;, &#39;password=2&#39;, &#39;confirmation=3&#39;]</code>的数组之后，我们为了得到<code>string = &#39;email=1&#39;</code>这种形式的，开始遍历数组，把数组的每个元素按照<code>=</code>分割，得到 <code>[email, 1]</code></li>
<li>用第二小节提供的<code>hash+[]</code>方法，处理成hash</li>
</ul>
<h2 id="服务器端简单的校验"><a href="#服务器端简单的校验" class="headerlink" title="服务器端简单的校验"></a>服务器端简单的校验</h2><p>既然服务器端已经获得了<code>formdata</code>了，那么应该进行一下简单的校验，比如邮箱的格式，没有问题了就把数据存到数据库里面。(目前校验水平很入门，没有涉及到完备的注册校验功能)</p>
<h3 id="校验前的准备工作"><a href="#校验前的准备工作" class="headerlink" title="校验前的准备工作"></a>校验前的准备工作</h3><p>上一节我们把formdata完美的封装到了hash里面，为了校验我们要把hash再拆开一个一个的看</p>
<p>或许这么做是最直接的</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> email = hash[<span class="string">'emai'</span>]</span><br><span class="line"><span class="keyword">let</span> password = hash[<span class="string">'password'</span>]</span><br><span class="line"><span class="keyword">let</span> password_confirmation = hash[<span class="string">'password_confirmation'</span>]</span><br></pre></td></tr></table></figure>
<p>不过ES6提供了一种解构赋值的语法糖，很甜很贴心……</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123;email, password, password_confirmation&#125; = hash</span><br></pre></td></tr></table></figure>
<h3 id="由-编码引发的bug"><a href="#由-编码引发的bug" class="headerlink" title="由@编码引发的bug"></a>由@编码引发的bug</h3><p>好了，我们这一步就先看看邮箱格式是否正确。</p>
<p>我是菜鸟级校验邮箱，看到了邮箱的独特标志---<code>@</code>，最起码有这个标志才叫邮箱吧，也就是说没有这个标志，我就可以认为邮箱格式不对啊，翻译成代码就是</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (email.indexOf(<span class="string">'@'</span>) === <span class="number">-1</span>) &#123;</span><br><span class="line">  response.statusCode = <span class="number">400</span></span><br><span class="line">  response.write(<span class="string">'email is bad'</span>) <span class="comment">//单引号只是为了标记这是一个字符串</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>很好，目前来说，事情的发展都很正常，直到一个bug的到来。</p>
<p><img src="http://p3tha6q4v.bkt.clouddn.com/18-2-8/63886564.jpg" alt="正常的也报错了"></p>
<p>一个合法的邮箱，却进入了非法邮箱处理的代码片段里面……</p>
<p><img src="http://p3tha6q4v.bkt.clouddn.com/18-2-8/3076171.jpg" alt="很疑惑"></p>
<p>毫无疑问，邮箱是合法的，代码也是合理的，那么出问题的必然是我，某个地方的理解有问题。</p>
<ul>
<li>找bug,把可能出错的代码片段分成几个区间，打log.</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(email.indexOf(<span class="string">'@'</span>))</span><br><span class="line"><span class="built_in">console</span>.log(email)</span><br></pre></td></tr></table></figure>
<p><img src="http://p3tha6q4v.bkt.clouddn.com/18-2-8/74625962.jpg" alt="真的是-1"></p>
<p>没错，<code>email</code>这个字符串的<code>@</code>索引真的是-1，可是我的邮箱写的明明有<code>@</code>啊。</p>
<p>为啥呢，接着又打印出了<code>email</code>的内容，终于真相大白了，<code>email</code>字符串里面真的没有<code>@</code>，</p>
<p>却发现了一串你没想到的<code>%40</code>，(⊙v⊙)嗯，没错了，这就是我认为的那个<code>@</code>的另一个形态。</p>
<ul>
<li>我在浏览器看到的只是浏览器想让我看到的东西而已，既然已经被浏览器处理了，那到了服务器端自然无法处理。</li>
<li>那这个<code>%40</code>哪来的呢</li>
</ul>
<p>Google走起，在<a href="https://www.w3schools.com/tags/ref_urlencode.asp" target="_blank" rel="noopener">w3schools的HTML URL Encoding Reference</a>找到了解释(不是国内的w3school……)</p>
<blockquote>
<p>URL encoding converts characters into a format that can be transmitted over the Internet.</p>
</blockquote>
<p>URL编码把字符转化成了一种可以在互联网上传播的格式，也就是说，我在网页上看到的字符是被URL编码处理的结果。</p>
<ul>
<li>那接下来就去搞定什么是URL编码</li>
</ul>
<p>搞定这个之前，文档先要让你明白啥是<code>URL</code></p>
<blockquote>
<p>Web browsers request pages from web servers by using a URL.</p>
<p>The URL is the address of a web page, like: <strong><a href="https://www.w3schools.com" target="_blank" rel="noopener">https://www.w3schools.com</a>.</strong></p>
</blockquote>
<p>Web浏览器通过使用URL从Web服务器请求页面。 该网址是网页的地址，例如：https：//<a href="http://www.w3schools.com。" target="_blank" rel="noopener">www.w3schools.com。</a></p>
<hr>
<p>复习一下URL的组成6部分：</p>
<p><a href="https://www.baidu.com/s?wd=hello&amp;rsv_spt=1#5" target="_blank" rel="noopener">https://www.baidu.com/s?wd=hello&amp;rsv_spt=1#5</a> 通过这个你就可以访问到一个 “唯一的” 网址</p>
<table>
<thead>
<tr>
<th>名字</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>https:</td>
<td>协议</td>
</tr>
<tr>
<td><a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a></td>
<td>域名</td>
</tr>
<tr>
<td>/s</td>
<td>路径</td>
</tr>
<tr>
<td>wd=hello&amp;rsv_spt=1</td>
<td>查询参数</td>
</tr>
<tr>
<td>#5</td>
<td>锚点</td>
</tr>
<tr>
<td>端口</td>
<td>默认80</td>
</tr>
</tbody>
</table>
<hr>
<p>复习完了<code>URL</code>，继续搞<code>URL编码</code></p>
<blockquote>
<p>URLs can only be sent over the Internet using the <a href="https://www.w3schools.com/charsets/ref_html_ascii.asp" target="_blank" rel="noopener">ASCII character-set</a>.</p>
<p>Since URLs often contain characters outside the ASCII set, the URL has to be converted into a valid ASCII format.</p>
<p>URL encoding replaces unsafe ASCII characters with a “%” followed by two hexadecimal digits.</p>
<p>URLs cannot contain spaces. URL encoding normally replaces a space with a plus (+) sign or with %20.</p>
</blockquote>
<ul>
<li>URL只能用ASCII编码在互联网之间发送。</li>
<li>既然URL通常包括ASCII字符编码集之外的字符(很明显嘛，ASCII码表太少)，所以URL必须转化成有效的ASCII格式。</li>
<li><strong>这是重点</strong>，URL编码使用<code>%</code>后面紧跟着两个16进制数字的编码格式来代替不安全的ASCII码表</li>
<li>URL不能包括空格。所以URL编码通常使用+号或者<code>20%</code>来代替空格。</li>
</ul>
<p>继续往下翻，找到了<code>%40</code>。</p>
<p><img src="http://p3tha6q4v.bkt.clouddn.com/18-2-8/97404637.jpg" alt="@符号的解释"></p>
<p>所以要把<code>value</code>的值解码回去</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hash[key] = <span class="built_in">decodeURIComponent</span>(value)</span><br></pre></td></tr></table></figure>
<p><code>decodeURIComponent()</code> 方法用于解码由 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent" target="_blank" rel="noopener"><code>encodeURIComponent</code></a> 方法或者其它类似方法编码的部分统一资源标识符（URI）。毕竟<code>URL</code>属于<code>URI</code>。</p>
<h3 id="错误信息的提示方法"><a href="#错误信息的提示方法" class="headerlink" title="错误信息的提示方法"></a>错误信息的提示方法</h3><p>如果有了错，需要提示用户错了，后端写的代码，用户不一定看的懂，需要前端润色一下使用户看懂，或者前端和后端沟通一下，maybe后端脾气不好，前端也是暴脾气，所以应该选择一个前后端都要用的东西做桥梁，很明显<code>JSON</code>是完美的候选人。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (email.indexOf(<span class="string">'@'</span>) === <span class="number">-1</span>) &#123;</span><br><span class="line">  response.statusCode = <span class="number">400</span></span><br><span class="line">  response.setHeader(<span class="string">'Content-Type'</span>, <span class="string">'application/json;charset=utf-8'</span>) <span class="comment">//直接告诉浏览器我是json</span></span><br><span class="line">  response.write(<span class="string">`</span></span><br><span class="line"><span class="string">    &#123;</span></span><br><span class="line"><span class="string">      "errors": &#123;</span></span><br><span class="line"><span class="string">      "email": "invalid"</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  `</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这就合理多了，后台只管写个json给前台看，其他不管了，前台翻译一下给用户看喽～</p>
<p>那么前台如何获得这个<code>json</code>呢</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$.post(<span class="string">'/sign_up'</span>, hash)</span><br><span class="line">.then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//成功了就打印这个  </span></span><br><span class="line">  <span class="built_in">console</span>.log(response)</span><br><span class="line">&#125;,</span><br><span class="line">(request, b, c) =&gt; &#123;</span><br><span class="line">   <span class="built_in">console</span>.log(request)</span><br><span class="line">   <span class="built_in">console</span>.log(b)</span><br><span class="line">   <span class="built_in">console</span>.log(c)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>忘记了错误函数里面的参数是啥了，那就都打印出来看看。</p>
<p><img src="http://p3tha6q4v.bkt.clouddn.com/18-2-8/48577590.jpg" alt="如果没用JSON的话"></p>
<p>可以看到，如果没用JSON的话，request对象里面有一个后端写的responseText属性可以利用。</p>
<p><img src="http://p3tha6q4v.bkt.clouddn.com/18-2-8/53044190.jpg" alt=""></p>
<p>设置了<code>Content-Type:application/json;charset=utf-8</code>之后，可以利用多出来的<code>responseJSON</code>属性，获得json的内容啊。</p>
<p>最终失败函数里面写</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(request) =&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> &#123;errors&#125; = request.responseJSON	</span><br><span class="line">  <span class="keyword">if</span> (errors.email &amp;&amp; errors.email === <span class="string">'invalid'</span>) &#123;</span><br><span class="line">    $form.find(<span class="string">'[name="email"]'</span>).siblings(<span class="string">'.errors'</span>).text(<span class="string">'您输入的邮箱错啦'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="校验邮箱是否已经存在了"><a href="#校验邮箱是否已经存在了" class="headerlink" title="校验邮箱是否已经存在了"></a>校验邮箱是否已经存在了</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> users = fs.readFileSync(<span class="string">'./db/users'</span>, <span class="string">'utf8'</span>)</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  users = <span class="built_in">JSON</span>.parse(users) <span class="comment">//[] JSON也支持数组</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (exception) &#123;</span><br><span class="line">  users = []</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> inUse = <span class="literal">false</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; users.length; i++) &#123;</span><br><span class="line">  <span class="keyword">let</span> user = users[i]</span><br><span class="line">  <span class="keyword">if</span> (user.email === email) &#123;</span><br><span class="line">    inUse = <span class="literal">true</span></span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (inUse) &#123;</span><br><span class="line">  response.statusCode = <span class="number">400</span></span><br><span class="line">  response.setHeader(<span class="string">'Content-Type'</span>, <span class="string">'application/json;charset=utf-8'</span>)</span><br><span class="line">  response.write(<span class="string">`</span></span><br><span class="line"><span class="string">    &#123;</span></span><br><span class="line"><span class="string">      "errors": &#123;</span></span><br><span class="line"><span class="string">      "email": "inUse"</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  `</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>本文并没有使用真正意义上的数据库，只是使用了简单的db文件做数据库，其实就是存的数组，也就是users其实就是数组<code>[]</code>。</p>
<ul>
<li>之所以使用了<code>try{}catch(){}</code>，是因为一旦除了错，可以将其初始化为空数组，后续代码可以继续执行，可能并不严谨，不过本文是侧重了解注册的思路的。</li>
</ul>
<p>同样的，如果邮箱已经存在了，就提示用户</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (errors.email &amp;&amp; errors.email === <span class="string">'inUse'</span>) &#123;</span><br><span class="line">	$form.find(<span class="string">'[name="email"]'</span>).siblings(<span class="string">'.errors'</span>).text(<span class="string">'这个邮箱已被注册啦'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>后端校验必须很严格，因为可以通过<code>curl</code>越过前端的校验。</p>
<p><img src="http://p3tha6q4v.bkt.clouddn.com/18-2-8/55736025.jpg" alt="curl"></p>
<p><img src="http://p3tha6q4v.bkt.clouddn.com/18-2-8/7637310.jpg" alt="使用curl发起请求"></p>
<hr>
<h3 id="把信息写入数据库"><a href="#把信息写入数据库" class="headerlink" title="把信息写入数据库"></a>把信息写入数据库</h3><p>没有错误之后，就可以把信息写到数据库里面啦</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">users.push(&#123;<span class="attr">email</span>: email, <span class="attr">password</span>: password&#125;)<span class="comment">//是个对象啊</span></span><br><span class="line"><span class="keyword">var</span> usersString = <span class="built_in">JSON</span>.stringify(users)</span><br><span class="line">fs.writeFileSync(<span class="string">'./db/users'</span>, usersString)</span><br><span class="line">response.statusCode = <span class="number">200</span></span><br></pre></td></tr></table></figure>
<p>users实现是个对象，而对象是内存里面的东西，数据库里面应该存储的是字符串，所以用了<code>JSON.stringify(users)</code></p>
<p>好啦，上篇注册篇结束啦，下篇讲一讲如何登录以及<code>Cookie</code>登场</p>
<p>相关代码见<a href="https://github.com/codevvvv9/AJAXDemo_nodeJsServer/blob/master/sign_up.html" target="_blank" rel="noopener">sign_up.html</a></p>
<p><a href="https://github.com/codevvvv9/AJAXDemo_nodeJsServer/blob/master/server.js" target="_blank" rel="noopener">server.js</a></p>

        
                <blockquote style="margin: 2em 0 0;padding: 0.5em 1em;border-left: 3px solid #F44336;background-color: #F5F5F5;list-style: none;">
                    <p><strong>
                         
                            This blog is under a <a href="/creativecommons.html" target="_blank">CC BY-NC-SA 3.0 Unported License</a>
                        </strong>
                        <br>
                        <strong>本文链接：</strong><a href="https://codevvvv9.github.io/2018/02/09/一块小饼干-Cookie-的故事-上篇/">https://codevvvv9.github.io/2018/02/09/一块小饼干-Cookie-的故事-上篇/</a>
                    </p>
                </blockquote>
        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <!-- 使用 gitcoment -->
<div id="gitment-comment">
    <!-- Gitment 评论框 -->
<div id="container"></div>
</div>
<style>
    #gitment-comment{
        background-color: #eee;
        padding: 2pc;
    }
</style>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
    var gitment = new Gitment({
        id: 'https://codevvvv9.github.io/2018/02/09/一块小饼干-Cookie-的故事-上篇/', // 可选。默认为 location.href
        owner: 'codevvvv9',
        repo: 'gitalk-comments',
        oauth: {
            client_id: 'eaa718397d7fb04087e1',
            client_secret: '4a3ec626703295108b5194694ecbe378502287eb',
        },
    })
    gitment.render('container')
</script>


                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2018/02/09/一块小饼干的故事-Cookie-的故事-下篇/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2018/02/03/科学上网/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.jpeg" alt="shaolin-wu's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        wslsdust@163.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="wslsdust@163.com" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2018/10/">十月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/09/">九月 2018<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/08/">八月 2018<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/05/">五月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/03/">三月 2018<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/02/">二月 2018<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/01/">一月 2018<span class="sidebar_archives-count">9</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/12/">十二月 2017<span class="sidebar_archives-count">14</span></a>
            </li></ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/CSS学习/">CSS学习<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/categories/HTML学习/">HTML学习<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/categories/HTTP入门/">HTTP入门<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/HTTP高级知识/">HTTP高级知识<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/categories/JS语法详解/">JS语法详解<span class="sidebar_archives-count">9</span></a></li><li><a class="sidebar_archives-link" href="/categories/Linux入门/">Linux入门<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/Sass使用/">Sass使用<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/Vue的学习/">Vue的学习<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/jQuery学习/">jQuery学习<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/三省吾身/">三省吾身<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/categories/云音乐/">云音乐<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/前端之外/">前端之外<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/categories/同源的问题以及解决思路/">同源的问题以及解决思路<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/同源的问题及解决思路/">同源的问题及解决思路<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/服务器原理学习/">服务器原理学习<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/自动打包工具/">自动打包工具<span class="sidebar_archives-count">1</span></a>
            </li></ul>
        </li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/about" title="About">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                About
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">38</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->


<!-- Theme Material -->


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
        <a href="https://twitter.com/shaolinwu1" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-twitter">
                <span class="visuallyhidden">Twitter</span>
            </button><!--
     --></a>
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://github.com/codevvvv9" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    
        <a href="https://www.zhihu.com/people/wu-lin-25-41/activities" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-zhihu">
                <span class="visuallyhidden">Zhihu</span>
            </button><!--
     --></a>
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    

    <!-- V2EX -->
    

    <!-- Segmentfault -->
    
        <a href="https://segmentfault.com/u/codevvvv9" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-segmentfault">
                <span class="visuallyhidden">Segmentfault</span>
            </button><!--
     --></a>
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;<span year=""></span>&nbsp;WuShaoLin's Blog
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?Bn9UzEm8RrBSxqyZB0zPjA==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>









   <!-- Gitment -->





<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    var copyrightNow = new Date().getFullYear();
    var textContent = document.querySelector('span[year]')

    copyrightSince = 2017;
    if (copyrightSince === copyrightNow||copyrightSince === 0000) {
        textContent.textContent = copyrightNow
    } else {
        textContent.textContent = copyrightSince + ' - ' + copyrightNow
    }

    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.6 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
